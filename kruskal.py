import random
import numpy as np
import matplotlib.pyplot as plt

def GetData():
    X = np.array([
[-7.21110711436158	,3.43183294452389   ],
[-4.22080546095411	,1.10447552559827   ],
[2.28169011555929	,2.79709910299872   ],
[6.01956718231863	,2.34573281569194   ],
[-4.34775222925914	,-3.47971332986128  ],
[4.00000000000000	,-2.00000000000000  ],
[5.70925285979521	,-6.51233057270376  ],
[-7.21110711436158	,3.19204460439216   ],
[-3.86817554899568	,1.27373788333832   ],
[2.30990050851597	,2.30341722625693   ],
[6.03367237879697	,1.86615613542848   ],
[-4.20670026447577	,-3.81823804534137  ],
[4.00252408591642	,-2.23845603976762  ],
[6.27346071892870	,-6.44180459031208  ],
[-7.18289672140491	,2.85351988891207   ],
[-3.57196642295060	,1.69689377768843   ],
[2.33811090147264	,1.97899770725517   ],
[6.01956718231863	,1.51352622347005   ],
[-4.07975349617074	,-4.26960433264816  ],
[4.12947085422146	,-2.77445350594443  ],
[7.13387770410726	,-6.42769939383374  ],
[-7.18289672140491	,2.62783674525868   ],
[-3.47323004760224	,2.14826006499522   ],
[2.42274208034266	,1.59815740234007   ],
[6.00000000000000	,1.00000000000000   ],
[-3.17702092155716	,-4.29781472560484  ],
[4.19999683661314	,-3.12708341790285  ],
[7.72629595619742	,-6.27254223257203  ],
[-7.18289672140491	,2.28931202977859   ],
[-3.37449367225388	,2.71246792412870   ],
[2.43684727682100	,1.23142229390331   ],
[6.24525032597202	,1.01984434672825   ],
[-2.68333904481536	,-4.28370952912650  ],
[4.22820722956981	,-3.55023931225297  ],
[8.13534665406919	,-6.00454349948363  ],
[-7.18289672140491	,1.79563015303679   ],
[-3.36038847577554	,2.92404587130376   ],
[2.47916286625601	,0.935213167858229  ],
[6.62609063088713	,1.00573915024991   ],
[-2.14734157863855	,-4.62223424460658  ],
[4.27052281900482	,-3.97339520660308  ],
[8.44566097659261	,-5.73654476639522  ],
[-7.18289672140491	,1.34426386573000   ],
[-3.31807288634053	,3.29078097974052   ],
[2.56379404512603	,3.34720176565387   ],
[7.00000000000000	,1.00000000000000   ],
[-1.79471166668013	,-5.14412651430506  ],
[4.32694360491817	,-4.41065629743154  ],
[8.81239608502937	,-4.93254856713000  ],
[-7.00000000000000	,1.00000000000000   ],
[-3.28986249338386	,3.57288490930726   ],
[2.81768758173610	,3.00867705017378   ],
[7.48650761606569	,0.907002774901555  ],
[-1.72418568428844	,-5.53907201569851  ],
[4.38336439083152	,-4.77739140586830  ],
[8.86881687094272	,-4.52349786925822  ],
[-6.85847720240315	,3.44593814100223   ],
[-1.31513498641667	,3.60109530226394   ],
[3.07158111834617	,2.76888871004205   ],
[8.00000000000000	,1.00000000000000   ],
[-2.04860520329020	,-6.32896301848538  ],
[6.24525032597202	,-1.34982866163238  ],
[9.00000000000000	,-4.00000000000000  ],
[-6.50584729044473	,3.47414853395890   ],
[-1.20229341458997	,3.34720176565387   ],
[3.33957985143457	,2.54320556638866   ],
[6.49914386258209	,2.47267958399697   ],
[-2.66923384833703	,-6.72390851987882  ],
[6.38630229075539	,-1.58961700176411  ],
[-6.29426934326967	,3.38951735508888   ],
[-1.23050380754664	,2.86762508539041   ],
[3.57936819156630	,2.83941469243374   ],
[6.87998416749719	,2.50088997695365   ],
[-3.27575729690552	,-6.83675009170552  ],
[6.54145945201710	,-1.94224691372254  ],
[-6.22374336087798	,3.16383421143549   ],
[-1.17408302163330	,2.40215360160529   ],
[3.83326172817637	,3.20614980087050   ],
[7.13387770410726	,2.50088997695365   ],
[-3.82585995956067	,-6.89317087761887  ],
[6.59788023793045	,-2.22435084328928  ],
[-6.15321737848630	,2.88173028186875   ],
[-1.15997782515496	,2.17647045795189   ],
[4.11536565774312	,3.71393687409064   ],
[7.59934918789238	,2.47267958399697   ],
[-4.46059380108584	,-6.72390851987882  ],
[6.69661661327881	,-2.66161193411773  ],
[-6.44942650453138	,2.61373154878034   ],
[-1.15997782515496	,1.83794574247180   ],
[4.25641762252648	,3.43183294452389   ],
[7.93787390337247	,2.45857438751863   ],
[-4.92606528487096	,-6.52643576918210  ],
[6.73893220271382	,-3.08476782846784  ],
[-6.68921484466311	,2.44446919104030   ],
[-1.14587262867662	,1.31605347277333   ],
[4.29873321196150	,3.02278224665212   ],
[6.25935552245036	,3.84088364239567   ],
[-5.34922117922108	,-6.30075262552871  ],
[6.80945818510551	,-3.45150293690461  ],
[-6.92900318479484	,2.41625879808362   ],
[-1.14587262867662	,0.991633953771578  ],
[4.31283840843983	,2.62783674525868   ],
[6.71072180975715	,3.85498883887401   ],
[-5.68774589470117	,-6.00454349948363  ],
[7.00000000000000	,-4.00000000000000  ],
[-4.71448733769590	,3.53056931987225   ],
[-1.14587262867662	,0.596688452378139  ],
[4.42567998026654	,2.20468085090857   ],
[7.03514132875890	,3.85498883887401   ],
[-4.46059380108584	,-1.09593512502231  ],
[6.99282573932389	,-4.28370952912650  ],
[-4.70038214121758	,3.27667578326219   ],
[-1.79471166668013	,3.69983167761230   ],
[4.42567998026654	,1.79563015303679   ],
[7.62755958084906	,3.81267324943900   ],
[-4.00000000000000	,-1.00000000000000  ],
[7.00693093580223	,-4.49528747630156  ],
[-4.70038214121758	,2.83941469243374   ],
[-1.45618695120004	,3.77035766000398   ],
[4.48210076617989	,1.34426386573000   ],
[8.05071547519917	,3.81267324943900   ],
[-3.37449367225388	,-1.03951433910896  ],
[2.00000000000000	,-5.00000000000000  ],
[-4.70038214121758	,2.61373154878034   ],
[-0.962505074458240	,3.77035766000398   ],
[4.52441635561490	,0.977528757293241  ],
[-4.81322371304426	,-1.25109228628402  ],
[-2.75386502720705	,-1.09593512502231  ],
[2.45095247329934	,-5.77886035583024  ],
[-4.70038214121758	,2.26110163682192   ],
[-0.623980358978150	,3.77035766000398   ],
[5.86441002105692	,3.82677844591733   ],
[-4.79911851656594	,-1.68835337711247  ],
[-2.34481432933527	,-1.09593512502231  ],
[2.74716159934442	,-5.96222791004862  ],
[-4.70038214121758	,1.89436652838515   ],
[-0.271350447019722	,3.78446285648232   ],
[5.93493600344861	,3.50235892691558   ],
[-4.67217174826090	,-2.21024564681094  ],
[-1.62544930894008	,-1.11004032150065  ],
[3.45242142326127	,-6.18791105370201  ],
[-4.65806655178256	,1.58405220586173   ],
[2.25347972260262	,3.54467451635059   ],
[6.00000000000000	,3.00000000000000   ],
[-4.61575096234754	,-2.50645477285602  ],
[-1.13176743219828	,-1.11004032150065  ],
[4.00252408591642	,-6.47001498326875  ],
[-4.50290939052086	,1.21731709742497   ],
[2.23937452612428	,3.19204460439216   ],
[5.99135678936195	,2.69836272765036   ],
[-4.53111978347752	,-2.97192625664114  ],
[3.87557731761138	,-1.47677542993741  ],
[5.14504500066172	,-6.51233057270376  ],
    ])
    return X

def Euclidean(x,y):
    return np.sqrt(np.sum((x-y)**2))

class DSU:
    def __init__(self, n):
        self.n = n
        self.p = np.ones(n, dtype=int) * -1
    def Get(self, x):
        if self.p[x] == -1: return x
        self.p[x] = self.Get(self.p[x])
        return self.p[x]
    def Union(self, a, b):
        a = self.Get(a)
        b = self.Get(b)
        if a == b: return
        if random.randint(0,1) == 0:
            self.p[a] = b
        else:
            self.p[b] = a

def Kruskal(X, needclasses, ro=Euclidean):
    l = X.shape[0]
    edges = []
    for i in range(l):
        for j in range(i+1,l):
            edges.append((ro(X[i],X[j]), i, j))
    edges = sorted(edges, key=lambda x: x[0])

    union = DSU(l)
    classes = l
    now = 0
    costs = []
    nclasses=[]
    while classes > needclasses:
        a = edges[now][1]
        b = edges[now][2]
        if union.Get(a) != union.Get(b):
            costs.append(edges[now][0])
            nclasses.append(classes-1)
            union.Union(a, b)
            classes -= 1
        now += 1

    # form classes
    dict = {}
    classes = 0
    for i in range(l):
        now = union.Get(i)
        if now not in dict:
            dict[now] = classes
            classes += 1


    y = np.zeros(l)
    for i in range(l):
        now = union.Get(i)
        y[i] = dict[now]

    # plt.plot(nclasses, costs)
    # plt.show()

    return y

X = GetData()
y = Kruskal(X,9)

print(y)
colors=['red','green','blue','pink','purple','yellow','brown','black','gray']
ncolor=[]
for i in range(len(y)):
    pos = int(y[i])
    ncolor.append(colors[pos])
plt.scatter(X[:,0],X[:,1], c=ncolor)
plt.show()